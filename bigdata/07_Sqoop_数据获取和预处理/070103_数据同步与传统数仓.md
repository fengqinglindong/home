## 数据同步 ##

要分析业务系统的数据，可以直接访问业务系统的数据库，进行分析。如下图：

![](https://i.imgur.com/72ytEth.png)  

业务应用和数据分析服务依赖于同一个数据库，数据库既要OLTP事物性操作（比如线上用户请求），又要处理OLAP的查询（离线的数据分析请求),上图可以保证数据的实时性，缺点数据库会产生额外的压力，进而影响线上的服务质量。


## 主从同步 ##
为了避免线上应用与数据分析任务在数据库上的相互影响，使用主从复制框架。

![](https://i.imgur.com/dh2A9x0.png)

业务系统访问数据库的master节点，数据分析访问数据库的slave节点。master与slave直接使用主从同步的方式保持数据一致。
核心在于主从同步，原理是？  
例如：在MySQL中，每一个数据请求都会在binlog中生成一条日志记录，比如哪个时间哪个表增加了哪条数据等等，将master产生的binlog同步到slave中，再在slave上把记录转成操作，形成与master中一样的数据。这样就实现了数据同步。

## 传统数仓数据 ##  
主从同步框架解决了在线离线不同应用直接相互影响的问题，但可查询的数据还是仅限于某个应用系统中，未能实现不同服务的数据打通，生成统一的数据视图。不能完全满足数据分析师的需求。为结局数据孤岛问题，使用传统的数据仓库工具聚合业务数据。如下图：
![](https://i.imgur.com/chFMfua.png)  

MySQL、Oracle的数据需要etl清洗聚合，导入到数据仓库服务中，然后数据仓库系统再作为统一的数据源，直接对接报表系统或者数据挖掘、数据分析服务。传统数据仓库服务包括Teradata、ODS、Oracle，提供了sql语法，支持JDBC、ODBC连接，接入方便。

缺点：代码闭源、价格昂贵、扩容复杂、性能瓶颈（如可能认识的人）。

